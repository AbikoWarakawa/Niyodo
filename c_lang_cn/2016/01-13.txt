00:00 StardustX: lh_mouse, 你刚才是不是用了日文字体。看着有点像MS Mincho
00:07 lh_mouse: StardustX, 西文字体。
00:08 hatelis quit:Quit: Leaving
00:13 lh_mouse quit:Quit: Meow
00:15 lh_mouse joined channel
00:18 lh_mouse: geordi, { auto ptr = __builtin_alloca(sizeof(int) * 5); iota_n(ptr, 5, 1); cout <<ptr[4]; }
00:18 geordi: error: 'iota_n' was not declared in this scope
00:18 lh_mouse: geordi, { auto ptr = __builtin_alloca(sizeof(int) * 5); itoa_n(ptr, 5, 1); cout <<ptr[4]; }
00:18 geordi: error: 'itoa_n' was not declared in this scope
00:18 lh_mouse: geordi, { auto ptr = __builtin_alloca(sizeof(int) * 5); itoa(ptr, ptr + 5, 1); cout <<ptr[4]; }
00:18 geordi: error: pointer of type 'void *' used in arithmetic
00:19 lh_mouse: geordi, { auto ptr = static_cast<int *>(__builtin_alloca(sizeof(int) * 5)); itoa(ptr, ptr + 5, 1); cout <<ptr[4]; }
00:19 geordi: error: 'itoa' was not declared in this scope
00:19 lh_mouse: geordi, { auto ptr = static_cast<int *>(__builtin_alloca(sizeof(int) * 5)); iota(ptr, ptr + 5, 1); cout <<ptr[4]; }
00:19 geordi: 5
01:03 lh_mouse: http://news.baidu.com/ns?cl=2&rn=20&tn=news&word=血友病吧%20百度贴吧
01:03 lh_mouse: 报应。
01:35 lh_mouse quit:Read error: Connection reset by peer
01:38 Stevearzh quit:Ping timeout: 256 seconds
01:38 Stevearzh joined channel
01:38 Stevearzh quit:Changing host
01:38 Stevearzh joined channel
02:18 gagaffer joined channel
02:19 gagaffer quit:Client Quit
02:20 lostabaddon joined channel
02:30 lostabaddon quit:Quit: 离开
02:51 lostabaddon joined channel
03:00 lostabaddon quit:Quit: 离开
03:20 StardustX quit:Quit: Connection closed for inactivity
03:35 xxxxxxxx quit:Quit: Leaving...
03:54 Stevearzh quit:Ping timeout: 240 seconds
03:55 Stevearzh joined channel
03:55 Stevearzh quit:Changing host
03:55 Stevearzh joined channel
05:15 Youmu quit:Quit: Connection closed for inactivity
05:42 linearain joined channel
05:42 linearain: Hello
05:43 linearain: Can someone teach me chinese meditation? :P
05:48 linearain quit:Ping timeout: 272 seconds
05:51 linearain joined channel
05:57 linearain: Hi
06:00 linearain quit:Quit: Bye
06:00 linearain joined channel
06:38 linearain quit:Remote host closed the connection
06:40 linearain joined channel
07:18 linearain: Hi
07:18 linearain: Geordi, hi
07:18 geordi: error: 'hi' does not name a type
07:19 linearain: Geordi, cout << hi;
07:19 geordi: error: 'cout' does not name a type
07:19 linearain: Geordi, {cout << hi;}
07:19 geordi: error: 'hi' was not declared in this scope
07:20 linearain: Geordi, {cout << "hi";}
07:20 geordi: hi
07:21 linearain quit:Quit: Bye
07:46 randomclown joined channel
08:06 hoxily quit:Ping timeout: 272 seconds
08:28 linearain joined channel
08:28 linearain: hi
08:28 linearain: hi
08:38 iyzsong: hi!
08:38 linearain: hard to find anyone here
08:38 linearain: are you all sleeping?
08:39 iyzsong: no, it's 8:30 am, most should up alrealy, well it depends
08:40 linearain: 2.30am here
08:40 iyzsong: you're the one should sleep :-
08:40 linearain: i cant fall asleep :(
08:41 linearain: i tried to meditate :D
08:41 iyzsong: ok = =
08:43 linearain: do you ever meditate?
08:44 iyzsong: no, i don't know that.
09:18 tutu_wind joined channel
09:18 tutu_wind: morning ~
09:27 iyzsong: 膜
09:27 linearain: hi
09:28 lh_mouse joined channel
09:34 StardustX joined channel
09:39 tutu_wind: iyzsong: 反膜
09:40 linearain: anygod know a good chinese movie for me? ^^
09:40 linearain: maybe it will help me fall asleep
09:40 Youmu joined channel
09:47 endle joined channel
09:55 linearain quit:Quit: ChatZilla 0.9.92 [Firefox 42.0/20151029151421]
10:23 tutu_wind quit:Quit: WeeChat 1.2
10:38 lh_mouse quit:Read error: Connection reset by peer
10:40 tutu_wind joined channel
10:40 lh_mouse joined channel
10:56 tutu_wind quit:Quit: WeeChat 1.2
10:58 tutu_wind joined channel
11:06 whatofor_1 joined channel
11:06 whatofor quit:Read error: Connection reset by peer
11:11 whatofor joined channel
11:11 endle quit:Quit: Leaving
11:14 whatofor_1 quit:Ping timeout: 260 seconds
11:27 tutu_wind quit:Ping timeout: 260 seconds
11:30 hoxily` joined channel
11:30 tutu_wind joined channel
11:50 Stevearzh quit:Quit: Be back later...
11:51 Stevearzh joined channel
11:55 Stevearzh quit:Ping timeout: 245 seconds
13:01 pocmon joined channel
13:16 lh_mouse quit:Read error: Connection reset by peer
13:23 tutu_wind: lhanjian: hj酱有木有用过GDB远程调试？
13:29 Stevearzh joined channel
13:49 varna joined channel
13:56 pocmon quit:Ping timeout: 260 seconds
14:05 lh_mouse joined channel
14:10 pocmon joined channel
14:16 pocmon quit:Ping timeout: 250 seconds
14:21 tutu_wind: lh_mouse: ping
14:35 tutu_wind quit:Ping timeout: 260 seconds
14:43 tutu_wind joined channel
14:47 hatelis joined channel
14:50 varna: 法师来了
14:59 tutu_wind: varna: 羊驼酱，远程调试的时候，有read系统调用，总是过不去～
14:59 tutu_wind: varna: 一直阻塞在那里。
14:59 varna: 它阻塞，当然你就阻塞了
15:00 varna: 你得真正从某个地方给他输入啊
15:01 tutu_wind: varna: 将被调试程序的STDIN_FILENO给绑到terminal的输入上？
15:01 varna: 随你，你甚至可以dup2
15:01 varna: 不过前提是你希望扭曲程序的标准输入输出
15:02 varna: 不推荐这么做，可能会影响调试效果，因为执行的时候可能给命令行参数的
15:02 tutu_wind: varna: 目前拿到的只有可执行程序,没办法改源码。
15:02 varna: 谁让你改的
15:02 varna: 你没有权力去改
15:02 varna: 按说现在应该是fork出一个进程，然后挂上gdb吧
15:03 varna: 之后用mi命令启动调试
15:03 varna: 命令行是gdb --interpreter mi TARGET
15:03 tutu_wind: 暂时还在用gdbserver 测试
15:04 varna: gdbserver是走CLI接口的……
15:04 varna: 它要read的时候应该会在客户端上提示你吧
15:05 tutu_wind: varna: 我试一下
15:05 ASenR joined channel
15:07 tutu_wind: varna: +
15:07 hatelis: varna, 膜
15:07 varna: 暴不取
15:07 varna: 我给p7加一点点东西
15:10 varna: gcc有没有C的参数缺省值扩展……我查查
15:12 varna: 似乎没有
15:12 varna: 不定参转发也只限于内联展开可行的场合
15:19 varna: hatelis: 为了不影响p7_init, 我开始加preinit...
15:21 hatelis: varna, 还是保持简单吧……这种东西搞多了蛋疼啊，而且收益有没有打个问号
15:22 varna: 不是收益
15:22 varna: 是我一时懒得变化p7_init的原型了
15:22 varna: 也许以后会改成直接拿一个struct p7_config
15:23 varna: 不过我一时懒得改
15:23 hatelis: varna, 那还是一部改到位吧，不然以后自己都搞不清楚到底咋init了
15:24 varna: 我想到一个诡异的主意
15:25 varna: 我保留现在所有的渣实现，但我做几个wrapper
15:26 hatelis: 像那些closure一样？
15:27 varna: 不
15:27 varna: 更糟糕
15:27 varna: 现有的所有接口保留，原有的p7_init变成内部用的p7_init_real
15:27 hatelis: 。
15:27 hatelis: 不直白了/
15:27 varna: 没完呢
15:28 varna: 对于所有不高于0.3的库版本，链接时把符号p7_init_0_3变成p7_init@LIBP7_0_3
15:28 varna: 此后的库版本用p7_init_0_4，链接时符号生成p7_init@@LIBP7_0.4
15:28 varna: 上面的LIBP7_0_3应该是LIBP7_0.3
15:29 tutu_wind quit:Quit: WeeChat 1.2
15:30 varna: 最后你会在链接的时候看到根据版本而变化的符号
15:31 varna: 现在直白点了么
15:35 hatelis quit:Excess Flood
15:35 hatelis_ joined channel
15:35 hatelis_: 。
15:35 hatelis_: nick hatelis
15:35 hatelis_ is now known as hatelis
15:38 hatelis quit:Remote host closed the connection
15:40 StardustX quit:Quit: Connection closed for inactivity
15:40 hatelis joined channel
15:47 varna: 我驲
15:47 varna: 忘事了
15:48 varna: 现在我只能兼容二进制（笑）
15:48 hatelis: 。
15:48 varna: 原型变了
15:50 varna: hatelis: 已push
15:53 varna: 缺省链接的p7_init是0.4版本
15:54 varna: 如果版本不高于0.3，会链接0.1
15:54 varna: 这里我保证新库的二进制发布兼容在编译时指定链接的旧应用
15:56 varna: 啊，有一个地方要改
15:57 varna: hatelis: 再pull一次
15:58 lh_mouse: 何不用 namespace？（笑）
15:58 varna: 说得太好了！
15:59 lh_mouse: (｡･ω･)ﾉ
16:06 hatelis: __asm__(".symver p7_init_0_1,p7_init@LIBP7_0.1");
16:06 hatelis: 原来还有这种玩法
16:07 Youmu: 这么厉害。。
16:07 varna: 下策
16:08 hatelis: varna, 我只觉得在基本没有用户的时候，还不需要考虑兼容性的问题
16:08 varna: 你总盯着用户
16:08 hatelis: 恰恰相反，这次完全可以忽略用户
16:08 varna: 不
16:08 varna: 你在衡量用户的多少
16:09 varna: 而我把这些所谓的用户当作确实存在的空气
16:09 varna: 所以我做看上去可以做的事
16:12 hatelis: 。
16:15 hoxily` quit:Quit: http://www.kiwiirc.com/ - A hand crafted IRC client
16:17 lh_mouse: 如果 poseidon 的用户达到 20 人ヲ就可以考虑发一个 alpha。  (I would release an alpha version of `poseidon` should number of its users exceed 20.)
16:18 * lh_mouse 飘起来了。
16:18 * varna 看着一个拴着耗的气球飘起来了。
16:34 varna: http://imgsrc.baidu.com/forum/w%3D580/sign=99bcd0278d82b9013dadc33b438da97e/7f95fa4f78f0f736f983b7010d55b319eac413a7.jpg 杯兔
16:35 hatelis quit:Quit: Leaving
16:40 pocmon joined channel
16:56 StardustX joined channel
17:38 tutu1234 joined channel
17:41 pocmon quit:Ping timeout: 264 seconds
18:10 Stevearzh_ joined channel
18:12 Stevearzh quit:Ping timeout: 240 seconds
18:15 tutu1234 quit:Quit: WeeChat 1.2
18:36 Mokou joined channel
18:37 Mokou: varna: 对了，有啥书推荐吗
18:37 Mokou: 适合在飞机上读的那种
18:37 varna: 《自然辩证法》
18:38 varna: 或者还有个选择：p99的文档
18:40 varna_ joined channel
18:40 varna quit:Disconnected by services
18:40 varna_ is now known as varna
18:52 Mokou: 马克思……
18:54 varna: 恩格斯
18:54 randomclown_ joined channel
18:58 varna: 这4-3打得桶小亏，还算凑合
18:59 varna: Mokou: pull一下p7和K, 都有更新
18:59 Mokou: http://ww4.sinaimg.cn/bmiddle/48ed25f6gw1ezxxqqa1noj20h90nzjtx.jpg
18:59 Mokou: 了解
18:59 varna: 独特的233333
19:00 Mokou: “笑死我了。室友问2的12次方是多少，另一个室友装逼口爽了半天，什么2的12次就是4的6次方就是8的三次方，然后8864，4832，6848，合起来就是512”
19:02 varna: 2^12是4K啊……
19:02 varna: 上将高雄表示肩有点酸了
19:02 varna: 提督虽然认为这是胸部过大所致但还是换了人
19:03 Mokou: 割掉
19:03 Mokou: http://ww2.sinaimg.cn/bmiddle/8e64d47ejw1ezxwdlmhr1j20qo1bf45m.jpg 亮点自寻系列
19:05 varna: 全员禁言什么鬼
19:06 varna: 而且为什么发这么low的广告，觉得自己智商还不够低么
19:06 Mokou: 关键是还⑨
19:06 Mokou: 一看就要挂
19:07 lh_mouse quit:Read error: Connection reset by peer
19:07 lh_mouse joined channel
19:14 hoxily joined channel
19:17 whatofor_1 joined channel
19:20 whatofor|2 joined channel
19:20 whatofor quit:Ping timeout: 276 seconds
19:21 whatofor_1 quit:Ping timeout: 255 seconds
19:33 varna: _(:з」∠)_今天这4-3有点丧啊
19:33 varna: KTKM的反潜力根本压不住
19:34 varna: 还是五个潜艇的配置比较容易拿下
19:38 FrankHB joined channel
19:39 Mokou: varna: 小说有推荐吗，不太想读学术性太强的书……
19:40 Stevearzh_ quit:Quit: Be back later...
19:40 varna: 随便弄个轻小说看看
19:40 varna: 但我还是推荐p99的文档，那东西一千多页呢
19:40 varna: 简直哦瘊瘊
19:41 Mokou: 哦瘊瘊，但是我不确定kindle能不能在飞机上用
19:41 varna: 我驲
19:42 Youmu: Mokou: 不可以。。
19:42 varna: 啊，KTKM让贤了
19:42 varna: Mokou: 那就看看飞机上的杂志？
19:42 varna: 你要坐多长时间
19:42 Mokou: 去程大约3h
19:42 Mokou: 回来长，因为得转机
19:42 varna: 要不你问问空姐有没有泄欲服务
19:43 Mokou: uccu
19:43 Mokou: 回程是HKG->PVG->TAO
19:44 varna: 飞机火车上我一般看不进去书，所以只看他们的杂志
19:45 varna: 而且一般看个十几遍也就扔下了……
19:45 Mokou: 总之我再弄本村上小黄书试试
19:45 Mokou: 万一无聊了呢……
19:45 varna: 无聊了就拿起杂志再看十几遍
19:46 varna: 还可以跟邻座的大叔交换看
19:46 Mokou: 一般同样的内容我看不下去十几遍……
19:48 Mokou: 或者存几集坂上之云，万一可以用笔记本呢
19:48 varna: 说起来，以后我就不在频道at人pull了……
19:48 varna: 直接在我觉得关键的时候来个pull request吧
19:49 Mokou: 我倒想看空中浩劫，不过在飞机上看那玩意我怕被人打……
19:51 varna: 唉唉，以后要是有反潜更方便的地方就好了
19:51 varna: 打4-3总是亏桶
19:52 varna: 现在敌重巡准备开炮的时候我都吓得一哆嗦
19:59 varna: 对了问个事情：现在的MOOC平台都在干什么/怎么盈利/如何区分视频上传者和实际授课者的权利？
20:00 varna: 搜索到的就算了，求问一下一手或者二手的经验
20:02 Mokou: B站看空中浩劫华航006，弹幕：
20:02 Youmu: varna: 卖证书（超贵
20:02 Mokou: “是青天白日旗啊，还在民国时期？”
20:03 varna: Youmu: 视频上传和授课者有什么利益么
20:03 Youmu: varna: 这个就不清楚了。。
20:03 varna: thx
20:03 varna: 原来现在MOOC也可以办证啊
20:03 Youmu: 国内的mooc平台好像授课者会有工资。。
20:04 varna: 是授课不是投稿？
20:04 Youmu: edx cousera 上的就不清楚了。。
20:04 varna: 说国内的就ok
20:04 varna: 我比较困惑的就是授课和投稿双方怎么区分利益
20:04 Youmu: 有讨论区的， 老师需要去答疑之类的
20:05 varna: 哦，这样啊
20:05 Youmu: 可是大部分是 TA 回答的。。。
20:05 varna: 职业教师也ok的话，会有单独的合作协议？
20:05 Youmu: Orz
20:06 varna: 这不是我的问题……我老母学院里有些这样的事情，但是她不太清楚这行业的细节，我也不清楚所以问问
20:06 Youmu: 应该是，国内的课程好像已经是一节课多少钱明码标价了
20:06 varna: 这样啊
20:06 varna: 听起来味道不好
20:06 Youmu: OuO
20:06 varna: TA是哪里弄来的人？
20:07 hatlist joined channel
20:07 hatlist: 谈笑风生https://www.zhihu.com/question/38177279
20:07 hatlist: 谈笑风生https://www.zhihu.com/question/38177279
20:07 varna: 卧槽
20:07 varna: 卧槽这个作品太直接了
20:07 Mokou: 噗
20:07 Mokou: 华航的呼号居然是dynasty
20:08 varna: 我给那个题三次字点一个赞
20:08 Youmu: varna: 就是学校里老师的TA，或者也找学生之类的
20:08 varna: hatlist: lhj对MOOC平台在国内的运作和利益相关有了解么
20:08 varna: Youmu: 哦……多谢多谢，大帮助
20:08 hatlist: varna: 不太了解。以前用过网易云课堂，好像买了些coursera的版权
20:08 varna: 哦哦
20:10 hatlist: Youmu: 膜蛤膜蛤
20:11 Youmu: hatlist: O.O
20:11 varna: 这暗号对不上啊
20:11 varna: 拉出去，盒子炮用意！
20:15 varna: 我驲
20:15 varna: 我驲！
20:15 varna: 第一个我驲是潜艇点开幕打了补给239
20:15 varna: 第二个我驲是雷击大破……
20:15 Mokou: ……
20:15 varna: 这很麻烦啊
20:18 Mokou: 对面那个60多级的爱宕连闪了我三个夜战二连
20:18 Mokou: 嗯，全部是双炮双探
20:18 varna: 果然多两个修理槽还是不一样
20:18 hatlist: 回复赵赵作霖的评论: 301俗称续命病房，学名叫时间众筹研究室
20:18 varna: 即使熊成这样子也不担心明天没法出击
20:18 varna: hatlist: 2333333
20:19 varna: 三个疲劳，摩耶估计也是疲劳的锅才吃雷大破的
20:21 hatlist: Youmu: 知乎还是比蛤乎厉害啊
20:21 Youmu: hatlist: 我已经在朋友圈看到HR在秀了
20:21 hatelis joined channel
20:22 hatlist: Youmu: 秀啥？
20:22 Youmu: https://usercontent.irccloud-cdn.com/file/kOrqAZRP/mmexport1452687679119.jpg
20:22 Youmu: 秀这个
20:23 Youmu: 虽然没啥用
20:24 hatelis: Youmu, 这种奖杯不是没啥用，是没用
20:24 varna: ……没文化真可怕
20:25 varna: 逼乎令我憎恨的一点，不是因为有人装逼
20:25 hatelis: 某辣鸡存储厂，柜子里一堆奖杯，有毛用
20:25 whatofor joined channel
20:25 varna: 装逼人之常情，没什么可指责的
20:25 hatelis: whatofor, wtf兄来了
20:25 varna: 逼乎的恶心之处，在于它让二逼以为自己装腔作势就确实地有文化了
20:26 hatelis: http://mp.weixin.qq.com/s?__biz=MzIzMDEwMjk4NA==&mid=404456557&idx=1&sn=6bc5cc306e898ef9ae6979563ce38378&scene=23&srcid=0113gdHHHoHnqauZLUOIlnEJ#rd
20:26 hatelis: varna, 想多了。这个充其量说只能算知乎给了个平台。
20:26 varna: 我不是说社会影响
20:27 whatofor|2 quit:Ping timeout: 250 seconds
20:27 varna: 如果你认为我是在说这个的话，你想多了
20:27 varna: 而且老实说，这其实不是实质性的批评
20:27 hatelis: 以前知乎确实是只请身价比较高的伙计。现在后来的伙计觉得自己和高身价的伙计上同一个网站就觉得自己逼格才够二
20:27 varna: 我们想一下，仅仅装腔作势，哪里来的认同感？
20:27 varna: 来源就是不知耻的半吊子
20:28 varna: 我自己就是个半吊子，不过我认为我比多数人知耻
20:29 hatelis: 我觉得对于自己是个半吊子这回事知耻值得称赞，但是一般人也就半吊子，没必要觉得耻啊
20:29 varna: 知耻不是负面的
20:29 hatelis: 嗯
20:29 varna: 如果觉得自己不怎么样这个事实会打击到自己的话，心理上就有点弱气了
20:29 * hatelis 弱气
20:30 * hatelis 觉得自己弱气，于是更弱气，然后恶性循环
20:30 varna: 你那是gainess
20:30 Mokou: 你们都是gay
20:30 Mokou: 好恶心好震惊
20:30 varna: 身为基头四之一，这绝对始终伪装
20:30 varna: 噫，药娘
20:30 Mokou: 噫，才不是药娘
20:33 varna: 今天再练一级就好……
20:33 whocares_2 quit:Read error: Connection reset by peer
20:33 hoxily quit:Quit: Leaving
20:33 varna: 明天十级、后天再十级，八十级prpr
20:33 * varna 做梦中
20:34 varna: 我驲
20:34 varna: 霞吃雷中破……
20:35 varna: 世事难料
20:37 whocares_2 joined channel
20:37 whatofor: 公司网络一直断, 自动重连
20:38 ASenR quit:Remote host closed the connection
20:38 lh_mouse: http://paste.ubuntu.com/14486576/  
20:38 * lh_mouse 开心。
20:39 whatofor: You are the top expert on nano for windows 看起来很好厉害
20:40 hatelis: “You are the top expert on nano for windows since the nano maintainer and his 
20:40 hatelis: friends do not care. Why don't you just expand the list of allowed keys for 
20:40 hatelis: WIN32? Users could then decide whether and how they want to bind them.”
20:40 * lh_mouse 害羞了。
20:41 lh_mouse: 其实ヲ只是懒。
20:41 hatelis: top expert，震惊了。GNU中搞windows nano最厉害的，搞windows nano中最受GNU称赞的
20:42 * lh_mouse 棒打 GNU。
20:43 varna: OTL
20:43 lh_mouse: libstdc++ 看来是打算破罐子破摔了。
20:44 varna: 还漏呢？
20:46 varna: _(:з」∠)_这次一发开幕打了255
20:46 varna: 然而我甚至没用流改
20:46 varna: 运气太差……
20:48 Mokou: M!N!B!
20:49 varna: 霞还差2423到60，然而KTKM还差684到134……
20:49 Stevearzh_ joined channel
20:52 Mokou: OTL
20:52 Mokou: 瑞鹤还差19427到98
20:53 Mokou: Boss点连着三个T有利
20:53 Mokou: 就是要让你吃桶
20:54 varna: ok, 今天结束了
20:54 varna: 去1-1打一圈就好
21:00 varna: Mokou: 说起来，你那里跑100并发1M连接的ab, K和I的性能对比如何
21:03 Mokou: 我试试
21:09 Mokou: Izumo 总耗时52.155s 9ms内响应99%，最长20ms
21:10 Mokou: Kashiwara 总耗时54.367s 7ms响应99%，最长3014ms
21:11 varna: qps呢
21:12 Mokou: https://pastebin.mozilla.org/8856535
21:12 varna: thx
21:12 Mokou: I19173.76 K18393.55
21:12 varna: 还凑合
21:12 varna: 比我想的好多了
21:12 Mokou: 然而K那个最长响应是什么情况……
21:13 varna: 你看一眼Connection Times统计，里面是不是Connect的max最吃时间
21:13 Mokou: 是
21:13 varna: 如果是的话，就是线程0上的第一个协程（主流程）按照轮转原则被公平调度了
21:13 Mokou: accept的时候被调度走了？
21:13 varna: 这是顽疾，不过我不打算立刻解决它
21:14 varna: 调度走之后没立刻被调度回来，等了一些工人coro之后才回来
21:14 Mokou: 难怪……
21:14 Mokou: 我说怎么差距这么恐怖
21:14 hatlist: 也就是说没保证acceptor的优先权导致最大响应时间过长？
21:14 Mokou: Connect的max I是9，K是3011
21:14 hatelis quit:Quit: Leaving
21:15 Mokou: http://www.bilibili.com/video/av5317/ 复习一下这个
21:15 varna: hatlist: 我目前是这么猜的，不过我暂时不打算采取措施；再观察一下
21:16 hatlist: “等了一些工人coro”
21:16 hatlist: 是怎么回事
21:17 varna: fork on connection + 子进程先走 + 堆积
21:17 varna: 这只是个粗糙的猜想
21:17 varna: 我还有另外的怀疑，所以我还是打算不把本地这个当作唯一依据——虽然问题就摆在那里
21:17 hatlist: 哦，对，斩舰刀是可以一口气accept完的。
21:18 varna: 你提醒我了
21:18 varna: 我试试换个写法
21:19 hatlist: http://nginx.org/en/docs/ngx_core_module.html#multi_accept
21:20 hatlist: 不太对。nginx的默认multi-accept是关掉的
21:20 varna: 无所谓的
21:20 varna: 不过我以前是缺省multi-accept的
21:20 varna: 直接上用力上
21:20 varna: 我看是你灌得快还是我拿得快
21:23 Mokou: http://www.bilibili.com/video/av106814/ 居然有续作……
21:25 Mokou: http://www.bilibili.com/video/av563083/ 危险地带：池田犬作被水淹没不知所措
21:26 varna: 我驲哈哈哈哈
21:26 varna: gcc提示我EWOULDBLOCK和EAGAIN是一样的，不能用作case的标签
21:26 Mokou: 233333
21:27 Mokou: #if?
21:27 varna: 以前我是这么搞的
21:27 varna: 现在我选择狗呔
21:29 Mokou: 青叶可以改造了
21:30 varna: 我很欣慰，手工调整出来的结果和无脑iowrap的结果一样熊包
21:30 varna: 不管了
21:30 Mokou: ……
21:30 varna: 等到我确认这个问题到底是什么鬼再说
21:31 varna: 我刚才选择尽可能多accept, 在每个accept上创建协程；若不能accept, 就转入一次IO通知（但不完成）
21:32 varna: p7专门提供了一个IO通知，它不会完成任何IO, 只按读写条件在fd上等待
21:32 varna: 返回时按条件就绪
21:32 Mokou: 41
21:34 varna: Mokou: 我先把那个鬼畜改动push上去，你看看吧
21:35 varna: 已推
21:37 Mokou: 我再灌一轮试试
21:38 varna: 应该没什么差别
21:39 endle joined channel
21:39 Mokou: 3015
21:39 Mokou: 还真没区别……
21:39 varna: 不出错就行
21:39 Mokou: 有点奇怪，坑在notify上了？
21:39 varna: 我就想耍个花枪
21:39 varna: 不
21:40 varna: 协程创建在本线程上的时候会有切换
21:40 varna: 坑notify也可能
21:40 varna: 不过还是那句话，现在我不想profile
21:40 varna: 等到生产环境再profile, 以前小耗建议过我
21:41 hatlist: 过早的优化是万恶之源？
21:41 Mokou: io通知是et的还是lt的？
21:41 varna: 倒不是，我想看看这个问题究竟是什么样的
21:42 varna: Mokou: 你可以注明ET
21:42 Mokou: 默认lt？
21:42 varna: p7的ET模式是手工或上去的
21:42 varna: 看libp7.h
21:42 varna: 哦不对
21:42 varna: p7impl.h
21:42 Mokou: 了解
21:42 varna: ET不会这么坑的
21:43 varna: s/LT/ET/
21:43 varna: s/ET/LT/
21:43 varna: 一般来说这程度的本机，LT也够了
21:43 varna: 因为环回很假、连接很短，所以差别应该不大
21:44 hatlist: 如果我没记错，golang 那个 read只能是读多少返回多少，不能无理由返回半截的，那么算是bufferevent？
21:46 varna: 你的bufferevent是什么意味？
21:47 varna: 另外其实p7从未完成IO
21:47 varna: 你看到的iowrap其实是一坨iocrap
21:47 hatlist: 忽略上面那句话吧，在要求读多少返回多少的情况下，应该直接用LT就好了吧
21:47 varna: 没法预期读多少返回多少
21:47 varna: IO系统调用的返回就是那样子，读不够是正常的
21:47 hatlist: 哦，对
21:48 hatlist: 羊驼子是尽力保证是什么就是什么的
21:48 varna: LK 3.14以后，保证文件偏移操作是原子的
21:48 hatlist: 我靠，现在还保证这个了？
21:48 varna: 也就是说并发read-write系列不会混乱
21:48 varna: 手册上提的
21:48 varna: 不然p7里面我不敢用readv
21:48 hatlist: 我感觉这个不会混乱反而是给那些旧东西弄了个坑啊……
21:48 varna: 本来这件事情交给用户负责的话负担太重了
21:49 varna: 又是一个中间层（笑）或者一把锁
21:49 varna: 当然多数时候其实可以避免
21:49 varna: 但你看看p7调度循环里的readv
21:49 hatlist: 也许可以考虑下recvmmsg之类的？
21:49 varna: 其实也行，不过我直接开了个ET管道
21:50 StardustX quit:Quit: Connection closed for inactivity
21:51 varna: 写管道的部分其实更宽松
21:52 varna: LK应该保证不超过一页内存的管道写是原子的
21:54 varna: 当然实际上这个量应该是PIPE_BUF
21:54 varna: 参考pipe(7)
21:57 * iyzsong AFK
22:06 StardustX joined channel
22:10 Mokou: apr_pollset_poll: The timeout specified has expired (70007)
22:10 Mokou: Total of 999998 requests completed
22:10 * Mokou 自杀
22:14 varna: 怎么回事
22:14 Mokou: 并不知道
22:14 varna: 哪个服务器
22:14 varna: K?
22:14 Mokou: 我试着改了一下K
22:14 varna: 哦……
22:15 Mokou: 结果总有几个被饿死
22:15 varna: 怎么改的
22:16 Mokou: 一次accept一堆，然后一起创建coro
22:16 varna: 那样有点危险
22:16 Mokou: 我想试试把izumo的做法搬过来会怎么样
22:16 varna: 不过按说不该那么容易饿死
22:17 Mokou: 而且饿死以后服务器的响应是正常的
22:17 varna: 啊，我知道了
22:17 varna: 大概是有几个被挤下去了
22:17 Mokou: ……挤下去是什么情况
22:17 varna: 你在accept不能的时候是怎么处理的
22:18 Mokou: 打开coro_create_flag，关掉multi_accept_flag
22:18 varna: coro都创建完呢
22:18 varna: 走IO通知？
22:18 Mokou: 往下是do_multi_accept
22:18 Mokou: +
22:18 varna: 有点奇异
22:18 varna: 这问题我想想怎么办吧
22:18 varna: 锅应该是我的
22:19 Mokou: 不一定，我把coro_create里的yield注释掉了
22:19 varna: 噗
22:19 Mokou: 创建完以后手动yield
22:19 varna: 你这样
22:19 Mokou: 不然还是会被调走……
22:19 varna: 你创建完之后只有一次yield对吧
22:19 Mokou: +
22:20 varna: 这本来应该是好的
22:20 varna: 我想想怎么回事
22:22 varna: 原理不明
22:22 varna: 你先把K的修改push上去吧
22:22 varna: 我明天看看这是怎么回事
22:22 Mokou: ok
22:22 Mokou: 有点诡异啊，因为调低连接数的话是没问题的
22:23 varna: 你开了多少并发
22:23 Mokou: 100
22:23 varna: 连接1M就有问题对吧
22:23 Mokou: +
22:23 varna: 999997呢
22:23 Mokou: 至少0.1M没有问题
22:23 varna: 0.1M都出问题的话已经是致死量了
22:25 Mokou: 开始魔法了
22:25 Mokou: 我试了试999990，然后八百多次就炸了
22:25 varna: ...
22:25 varna: 500k呢
22:27 Mokou: apr_pollset_poll: The timeout specified has expired (70007)
22:27 Mokou: Total of 999988 requests completed
22:27 Mokou: ^999990
22:27 varna: 还是两个
22:27 Mokou: 500k愉快地跑完了
22:27 varna: 这锅我先背一下，总感觉是个顽疾
22:28 varna: 你推送到主分支吧
22:28 Mokou: ok
22:28 Mokou: 对p7的改动只有注释掉那个yield
22:28 varna: 我把修改拉下来跟它奋斗一段时间
22:28 varna: ok
22:29 Mokou: pushed
22:30 varna: wow, pull好快
22:30 Mokou: 只改了kashiwara.c
22:31 Mokou: 不过优化没有，0.5m还是3000+ms
22:31 varna: 这两个锅也许是一个
22:31 varna: 总之既然在某处出错了，我就先盯着代码看看
22:32 Mokou: 不对，我刚才数错零了……
22:32 Mokou: 我说怎么那么快
22:32 Mokou: apr_pollset_poll: The timeout specified has expired (70007)
22:32 Mokou: Total of 499998 requests completed
22:33 varna: 噗哈哈哈
22:33 varna: 300000呢
22:33 Mokou: 能跑完
22:33 Mokou: 3013ms
22:34 varna: 奇异
22:34 Mokou: 这样的话应该不完全是调度的锅？
22:34 varna: 不
22:34 Mokou: 这次连创建完coro的yield都被我飞了，直接跑到通知
22:34 varna: 走通知其实是一样的
22:34 varna: 因为会切回调度循环
22:34 varna: 我现在就看看调度循环里的顺序调整有没有问题
22:35 Mokou: 但是izumo的accept并没有特别的加权处理……
22:35 varna: 不是这个意思
22:35 varna: 你看看p7的调度代码就知道了，不算很安定的
22:37 Mokou: 代码好大一坨
22:37 Mokou: acceptor有可能会饿？
22:38 Mokou: http://imgsrc.baidu.com/forum/w%3D580%3B/sign=249a60aabe014a90813e46b5994c3812/10dfa9ec8a136327585d1d2b968fa0ec08fac772.jpg
22:39 varna: 调度代码只有循环的最后几行
22:39 varna: 我不知道谁被饿死了
22:39 varna: 现在我不作猜想了，先盯着看
22:41 Mokou: “突然有想打个喷嚏的感觉，可是到鼻子了却又消失了。没打出来非常难受，然后跑到一个女同事闻了一下她身上浓厚的香水，一口气打了好几个出来，舒畅是舒畅就是如果没有被打一顿就更好了”
22:43 Mokou: 噗
22:43 Mokou: 70w上315了
22:44 varna: 噗？
22:44 Mokou: 315官博发了血友病吧的70w事件
22:45 Mokou: http://weibo.com/ttarticle/p/show?id=2309403930926844352161
22:45 varna: ...
22:46 varna: 撤了
22:46 varna: 武运
22:46 varna quit:Quit: leaving
22:56 endle quit:Quit: Leaving
23:01 Mokou quit:Quit: 睡觉
23:35 Youmu quit:Quit: Connection closed for inactivity
