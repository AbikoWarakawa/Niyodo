00:02 cleamoon_: 看一个关于dowsing的 科 学 论文，感觉浑身都不好了
00:03 varna: dowsing是说勘探地下水的那种技术？
00:04 cc quit:Quit: xc:www.chnxc.net
00:05 lh_not_bot: varna: 
00:05 varna: (｡･ω･)ﾉ
00:05 lh_mouse: 用 SIMD 的 memcpy 使用 non-temporal 语义的阈值是多少。
00:05 cleamoon_: 是拿两个棍子找东西的
00:05 lh_mouse: 我这么说吧。
00:06 lh_mouse: 我这个机器，L3 是 8MiB，四核八线程。
00:06 lh_mouse: 使用 ERMSB （rep movsb ） 在大概 2MiB 左右出现明显性能下降，最后稳定到 7GiBps 左右。可以判定这个阈值大概是 L3 cache size / number of physical cores 。
00:07 lh_mouse: 但是我不知道你之前有没有研究过这个。
00:07 lh_mouse: cpuid 取不到物理核心数，只能取到逻辑核心数。
00:08 varna: 我没研究过这个事情，只听过流言说考虑L2
00:08 varna: 你确认是按照L3算的么
00:09 lh_mouse: 我这个 L2 只有 256KiB 。
00:09 varna: puuu
00:09 lh_mouse: 这个是之前按照 1MiB 阈值的测试结果。
00:09 lh_mouse: https://img.vim-cn.com/c4/44f1b8098f2ecdc7342a049aeabefdcf8e8efc.png
00:10 lh_mouse: NTDLL 是 movnti 。
00:10 lh_mouse: msvcr110  msvcr120  是 SSE2 。
00:10 lh_mouse: ucrtbase 是 rep movsb 。
00:11 lh_mouse: mcfcrt 是 SSE 。
00:11 lh_mouse: 64 字节以内打表， 64 - 1MiB 用  movups ，1MiB 以上用 movups + movntps 。
00:12 varna: 大概是我听到的流言比较旧了，以前说是直接填L2 lines
00:13 varna: 摸不着头脑
00:14 lh_mouse: 性能在 50GiBps 左右应该是 L1 命中，32GiBps 是 L2 命中，26GiBps 是 L3 命中，8GiBps 是内存的速度。
00:14 lh_mouse: 绿色折线有很明显的阶梯状下降。
00:16 lh_mouse: 我的处理器是超线程的，我认为按单物理核心去计算独占的 L3 对于另一个线程非常不公平。但是我又不知道具体这个怎么算。
00:16 lh_mouse: 我只能按 L3 / 4 这样写死个值。
00:16 lh_mouse: i5 上 L3 是 6MiB 。
00:17 varna: i5我记得2核4ht？
00:17 varna: HT算起来也是黑盒
00:17 lh_mouse: 4 核没有 ht 。
00:18 lh_mouse: 笔记本上是双核。
00:18 varna: 哦
00:23 varna: 我突然有个懵比的想法
00:23 lh_mouse: 0.0
00:24 varna: 如果对HT，按 L3 / (4*1.4) 算呢（虽说 L3 / 4 的结果已经明显了）
00:46 lh_mouse quit:Read error: Connection reset by peer
00:47 lh_mouse joined channel
00:50 varna quit:Ping timeout: 240 seconds
00:57 lh_mouse quit:Read error: Connection reset by peer
01:06 matchray: lh_not_bot: ERMSB rep movsb 也挺快的
01:06 matchray: 网上看到一个8000多行的memcpy .s后就不惊讶了
01:19 iyzsong quit:Ping timeout: 248 seconds
02:30 Youmu quit:Quit: Connection closed for inactivity
10:14 lh_mouse joined channel
10:14 Zenghui joined channel
10:21 Youmu joined channel
11:00 \s joined channel
11:16 meepoljd joined channel
11:16 meepoljd joined channel
11:32 cleamoon_ quit:Quit: Connection closed for inactivity
11:33 DuckSoft joined channel
11:45 meepoljd quit:Read error: Connection reset by peer
11:47 Zenghui quit:Ping timeout: 256 seconds
11:53 meepoljd joined channel
12:00 whocares_2_ quit:Ping timeout: 248 seconds
12:00 whocares_2 joined channel
12:10 hanjian_l: i5 3210就是双核4线程
12:11 hanjian_l: CPU(s):              4
12:11 hanjian_l: On-line CPU(s) list: 0-3
12:11 hanjian_l: Thread(s) per core:  2
12:11 hanjian_l: i5 4210U
12:11 hanjian_l: L3 是 3MiB
12:17 hanjian_l: https://www.irccloud.com/pastebin/AKqbPHE5/
12:23 hanjian_l: https://docs.microsoft.com/en-us/windows/iot-core/windows-iot + windows linux subsystem ,我们就有了一个Windows内核的unix-like OS了,而且是Ubuntu的仓库
12:42 meepoljd quit:Quit: Leaving.
12:43 meepoljd joined channel
14:54 meepoljd quit:Quit: Leaving.
15:37 yonka_ joined channel
15:40 yonka quit:Ping timeout: 256 seconds
15:55 cleamoon_ joined channel
16:04 gauge is now known as gg
16:04 gg is now known as gauge
16:18 matchray: varna: lh_mouse: 感覺需要引用計數
16:19 matchray: echo 'int a;' > a.cc; echo > b.cc; | 把定義複製到b.cc | 刪除a.cc的定義
16:19 lh_mouse: ??
16:19 matchray: 現在的效果是這個變量就失去定義了，因此無法 textDocument/definition；但可以 references
16:19 matchray: https://github.com/cquery-project/cquery/issues/403
16:20 matchray: 暫態的odr violation都是需要考慮的
16:21 lh_mouse: 不是很懂你们这帮鼓捣 ide 的。
16:21 matchray: 有什麼想法歡迎
16:22 matchray: https://reviews.llvm.org/D42895
16:22 matchray: https://reviews.llvm.org/D42893
16:23 matchray: lh_mouse: 搗鼓ide，不僅需要懂AST (向C++ mouse lawyer方向努力），還需要折騰multi-thread / db / posix-win 因此非常有趣
16:24 lh_mouse: 没♀有趣。（逃）
16:25 * lh_mouse 想要♀。
16:25 matchray: +1
16:26 matchray: 搗鼓ide，需要說服ms放棄utf-16
16:26 matchray: 需要寫diff algorithm
16:26 matchray: 需要noi text editor (實際上　用不着
16:26 matchray: fuzzy matching
16:26 matchray: lmdb
16:26 matchray: (實際上也沒發現能怎麼用上
16:28 matchray: 需要研究 color difference + graph coloring (semantic highlighting中設計配色使得符號間對比度大
16:28 matchray: 研究 graph visualization
16:28 matchray: arbitrary synbol hierarchy https://github.com/emacs-lsp/lsp-ui/issues/73
16:29 matchray: completion ergonomics https://github.com/cquery-project/cquery/pull/391
16:30 hanjian_l: int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);
16:30 matchray: reverse engineering https://github.com/cquery-project/cquery/blob/master/wscript#L127
16:30 hanjian_l: 其实int timeout改成int *timeout不错，像select timeout一样可以反应度过的时间
16:30 matchray: bsdtar 的 -s https://github.com/cquery-project/cquery/pull/407/files
16:31 matchray: freebsd 的 get executable path
16:32 matchray: hanjian_l: number of milliseconds in int ...
16:33 hanjian_l: matchray: 大多数时候可能都小于1ms吧
16:33 hanjian_l: 返回个负数好了
16:33 hanjian_l: 就跟windows那个ping一样
16:33 hanjian_l: time= <1ms
16:34 hanjian_l: 既然是int，那么<0就把单位设为ns好了
16:34 hanjian_l: >0就忽略ms
16:34 hanjian_l: >0就忽略ns
16:35 hanjian_l:  >0就忽略ns
16:35 hanjian_l: epoll渣渣
16:36 hanjian_l: 人家kqueue本来就是     kevent(int	kq, const struct kevent	*changelist, int nchanges, struct	kevent *eventlist, int nevents,	 const struct timespec *timeout);
16:36 hanjian_l: struct timespec *timeout
16:36 hanjian_l: 而且还可以批量关注fd
16:37 hanjian_l: fundamentally broken Linux
16:53 lh_mouse: hanjian_l, 没用。
16:54 hanjian_l: lh_mouse: y?
16:54 hanjian_l: nmap就用了*timeout测量PING/PONG时间
16:54 lh_mouse: 没什么球用。
16:54 lh_mouse: 这时间能干啥。
16:54 hanjian_l: ^^^
16:55 hanjian_l: 至少我不用前面来个gettimeofday，后面又来一个gettimeofday
16:55 hanjian_l: 也不用搞什么rtdsc
16:55 lh_mouse: 你那个需求不够普世。
16:56 hanjian_l: 人家bsd就觉得足够普世
16:56 hanjian_l: poorly linux
16:57 lh_mouse: 你如果这么说，我只能呵呵。
16:59 hanjian_l: 那就呵呵
16:59 hanjian_l: epoll就挺可悲的
17:00 hanjian_l: 到现在lkml还在为个preadv2还是那个什么什么调用如何和epoll貌似和谐地共处而折腾个不休
17:00 hanjian_l: 年年开Linux Conf都要讨论这个问题，都快拖上十年了吧？
17:01 hanjian_l: 历史遗留问题，历史遗留问题
17:01 lh_mouse: 跟我有什么关系。
17:01 hanjian_l: 没关系。
17:01 hanjian_l: .
17:02 hanjian_l: RWF_NOWAIT (since Linux 4.14)
17:02 hanjian_l: oh，他们终于拿出来了！
17:02 hanjian_l: fxxking good
17:02 hanjian_l: http://man7.org/linux/man-pages/man2/preadv2.2.html
17:04 hanjian_l: We have truly async disk io
17:14 hanjian_l: @varna
18:15 cleamoon_ quit:Quit: Connection closed for inactivity
18:16 cleamoon_ joined channel
19:01 L-ios quit:Quit: L-ios
19:15 L-ios joined channel
19:33 cleamoon_: 惊了，高法新规定，未满16岁偶尔和幼女发生关系不算犯罪
19:34 cleamoon_: 卧槽，还是13年的事
19:48 hanjian_l: 但是另一面是取消了嫖宿幼女罪
19:48 hanjian_l: 妹子们本来就早熟
19:52 cleamoon_: 有这个罪本身就很奇怪
19:57 cleamoon_: hanjian_l: 我记得梨花酱以前用过gentoo？
19:57 hanjian_l: 从没
20:00 cleamoon_: 那是这里的谁用gentoo做日常机来得....
20:02 hanjian_l: 萌新啊
20:02 cleamoon_: 似乎不是萌新..... 是某喜欢看编译的人.....
20:16 iyzsong joined channel
20:20 L-ios quit:Remote host closed the connection
20:20 L-ios joined channel
20:25 Youmu: cleamoon_: gauge 是哦
20:28 cleamoon_: orz
20:28 cleamoon_: 原来是物理大佬
21:45 lh_mouse quit:Ping timeout: 264 seconds
21:56 lh_mouse joined channel
21:58 gauge: gentoo \o/
21:59 iyzsong quit:Ping timeout: 240 seconds
22:00 cleamoon_: gauge: genkernel?
22:01 gauge: cleamoon_: 咱没试过这个...
22:03 gauge: 咱只会 make menuconfig ...
22:09 cleamoon_: orz
22:10 cleamoon_: gauge: 有没有遇到过开机时过了 grub 但是卡在启动各种东西时的情况
22:11 yonka_ quit:Ping timeout: 240 seconds
22:23 gauge: cleamoon_: 应该是有过 虽然现在想不起来是为啥了
22:23 gauge: cleamoon_: 是卡在哪一步了呢?
22:24 lh_mouse: Starting MTA...    <_<
22:26 gauge: 诶... 咱没装邮件啥的
22:32 cleamoon_: gauge: 我记得是各种东西像 cron 什么的都开始启动了，但还没进入 getty
22:33 cleamoon_: 但也没有kernel panic什么的，就好像启动到一半罢工了
22:38 gauge: cleamoon_: runlevel 换成 boot 是不是就能起来了?
22:41 cleamoon_: gauge: 没试过.... 我基本就是完全根据 handbook 上写的做的，配置内核还是用的自动配置
22:41 cleamoon_: gauge: 会不会换成systemd好一些，我没用过openrc
22:46 gauge: cleamoon_: 咱没试过在 gentoo 上用 systemd 似乎只要在配内核的地方改一下就可以了?
22:46 gauge: 不过 openrc 是 gentoo 的人写的呀 😂
22:51 cleamoon_: 我很不想自己配置内核..... 基本没弄对过
22:54 cleamoon_: gauge: USE有影响吗？我试的两次一次是把所有多媒体类的USE都加上了其他都没加，第二次是什么都没加
22:56 gauge: cleamoon_: 应该不会吧
22:57 gauge: handbook 上面提到需要安装的东西没啥特别的 use
22:58 cleamoon_: 在livedvd里用时没啥问题，就是不能boot......
23:00 gauge: 比如在 /etc/rc.conf 把 rc_logger 和 rc_verbose 打开 看看是卡在哪里了?
23:01 cleamoon_: 我试试在vbox里装行不行吧，就是不知道vbox里成功了能不能代表电脑也能成功.....
23:03 cleamoon_: gauge: 对了，我比handbook多做了一步，就是load了几个module，应该也没什么问题吧？
23:09 gauge: cleamoon_: 按理说 cron 都出来了应该没有问题
23:11 cleamoon_: gauge: 那些openrc启动的启动项显示了一串[OK] something starts之后，直接就跳到log式的那些类似 [0.123456] something starts了
23:15 gauge: cleamoon_: OuO 有时间的大概是 kernel 的输出?
23:16 cleamoon_: gauge: 可能是的
23:33 fy quit:Remote host closed the connection
23:33 fy joined channel
